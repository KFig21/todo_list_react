{"version":3,"sources":["services/firebase.js","hooks/use-user.js","components/navbar/Navbar.js","pages/signup/Signup.js"],"names":["doesUsernameExist","username","a","firebase","firestore","collection","where","get","result","docs","length","getUserByUserId","userId","map","item","data","docId","id","getListsByDocId","doc","addTask","listId","input","userDocRef","listsDocRef","tasksInListDocRef","tasksMainDocRef","dateCreated","Date","now","set","taskName","completed","due","urgent","taskIdList","taskIdMain","addList","listDocRef","listName","useUser","useState","activeUser","setActiveUser","user","useContext","UserContext","useEffect","uid","response","getUserObjByUserId","userInfo","Navbar","title","sidebarOpen","setSidebarOpen","FirebaseContext","navTitle","useHistory","undefined","className","onClick","to","Signup","history","setUsername","fullName","setFullName","emailAddress","setEmailAddress","password","setPassword","error","setError","isInvalid","buttonClass","setButtonClass","handleSignup","e","preventDefault","auth","createUserWithEmailAndPassword","createdUserResult","updateProfile","displayName","toLowerCase","push","ROUTES","message","document","onSubmit","type","placeholder","onChange","target","value","disabled"],"mappings":"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","file":"static/js/6.c8de1a7e.chunk.js","sourcesContent":["import { firebase, FieldValue } from \"../lib/firebase\";\r\n\r\nexport async function doesUsernameExist(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .where(\"username\", \"==\", username)\r\n    .get();\r\n\r\n  return result.docs.length > 0;\r\n}\r\n\r\nexport async function getUserByUsername(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .where(\"username\", \"==\", username)\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id,\r\n  }));\r\n}\r\n\r\n// get user from the firestore wher userId == userId(passed from the auth) 笨能r\nexport async function getUserByUserId(userId) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .where(\"userId\", \"==\", userId)\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id,\r\n  }));\r\n}\r\n\r\n// get lists (plural) 笨能r\nexport async function getListsByDocId(docId) {\r\n  let result = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .doc(docId)\r\n    .collection(\"lists\")\r\n    .get();\r\n\r\n  result = result.docs.map((item) => ({\r\n    ...item.data(),\r\n  }));\r\n\r\n  return result;\r\n}\r\n\r\n// get tasks 笨能r\nexport async function getTasksFromListId(listId, userId) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .doc(userId)\r\n    .collection(\"lists\")\r\n    .doc(listId)\r\n    .collection(\"tasks\")\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id,\r\n  }));\r\n}\r\n\r\n// add task 笨能r\nexport async function addTask(listId, userId, input) {\r\n  // var taskDocRef = await firebase\r\n  // .firestore()\r\n  // .collection(\"users\")\r\n  // .doc(userId)\r\n  // .collection(\"lists\")\r\n  // .doc(listId)\r\n  // .collection(\"tasks\")\r\n  // .doc();\r\n\r\n  var userDocRef = await firebase.firestore().collection(\"users\").doc(userId);\r\n\r\n  var listsDocRef = userDocRef.collection(\"lists\").doc(listId);\r\n  var tasksInListDocRef = listsDocRef.collection(\"tasks\").doc();\r\n  var tasksMainDocRef = userDocRef.collection(\"tasks\").doc();\r\n  var dateCreated = Date.now();\r\n  // var dateCreated = new Date().toString().split(\" \").splice(1, 3).join(\" \");\r\n\r\n  tasksInListDocRef.set({\r\n    taskName: input,\r\n    dateCreated: dateCreated,\r\n    completed: false,\r\n    due: dateCreated,\r\n    urgent: false,\r\n    taskIdList: tasksInListDocRef.id,\r\n    taskIdMain: tasksMainDocRef.id,\r\n  });\r\n\r\n  tasksMainDocRef.set({\r\n    taskName: input,\r\n    dateCreated: dateCreated,\r\n    completed: false,\r\n    due: dateCreated,\r\n    urgent: false,\r\n    taskIdList: tasksInListDocRef.id,\r\n    taskIdMain: tasksMainDocRef.id,\r\n  });\r\n}\r\n\r\n// add list\r\nexport async function addList(userId, input) {\r\n  var listDocRef = await firebase\r\n    .firestore()\r\n    .collection(\"users\")\r\n    .doc(userId)\r\n    .collection(\"lists\")\r\n    .doc();\r\n\r\n  listDocRef.set({\r\n    listName: input,\r\n    dateCreated: Date.now(),\r\n    listId: listDocRef.id,\r\n  });\r\n}\r\n","import { useState, useEffect, useContext } from \"react\";\r\nimport UserContext from \"../context/user\";\r\nimport { getUserByUserId } from \"../services/firebase\";\r\n\r\nexport default function useUser() {\r\n  const [activeUser, setActiveUser] = useState({});\r\n  const { user } = useContext(UserContext);\r\n\r\n  useEffect(() => {\r\n    async function getUserObjByUserId() {\r\n      const [response] = await getUserByUserId(user.uid);\r\n      setActiveUser(response);\r\n    }\r\n\r\n    if (user?.uid) {\r\n      getUserObjByUserId();\r\n    }\r\n  }, [user]);\r\n\r\n  // returns userInfo variable, cannot return user variable as that is used in userContext\r\n  return { userInfo: activeUser };\r\n}\r\n","import React, { useContext, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport \"./navbar.scss\";\r\nimport FirebaseContext from \"../../context/firebase\";\r\nimport UserContext from \"../../context/user\";\r\nimport useUser from \"../../hooks/use-user\";\r\n// icons\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\n\r\nexport default function Navbar({ title, sidebarOpen, setSidebarOpen }) {\r\n  const { firebase } = useContext(FirebaseContext);\r\n  const { user } = useContext(UserContext);\r\n  const { userInfo } = useUser();\r\n  const history = useHistory();\r\n  let navTitle = title === undefined ? \"To-Do List\" : title;\r\n\r\n  return (\r\n    <div className=\"navbar\">\r\n      <div className=\"relative\">\r\n        <div className=\"left\">\r\n          <div\r\n            className=\"hamburger\"\r\n            onClick={() => setSidebarOpen(!sidebarOpen)}\r\n          >\r\n            <MenuIcon className=\"icon\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"middle\">\r\n          <Link className=\"link-title\" to=\"/\">\r\n            <h2>{`${navTitle}`}</h2>\r\n          </Link>\r\n        </div>\r\n        <div className=\"right\">\r\n          {!user && (\r\n            <>\r\n              <Link to=\"/login\">\r\n                <button>Login</button>\r\n              </Link>\r\n              <Link to=\"/signup\">\r\n                <button>Signup</button>\r\n              </Link>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import \"./signup.scss\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport React, { useState, useContext, useEffect } from \"react\";\r\nimport FirebaseContext from \"../../context/firebase\";\r\nimport * as ROUTES from \"../../constants/routes\";\r\nimport { doesUsernameExist } from \"../../services/firebase\";\r\nimport Navbar from \"../../components/navbar/Navbar\";\r\n\r\nexport default function Signup() {\r\n  const history = useHistory();\r\n  const { firebase } = useContext(FirebaseContext);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [fullName, setFullName] = useState(\"\");\r\n  const [emailAddress, setEmailAddress] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const isInvalid = password === \"\" || emailAddress === \"\";\r\n  const [buttonClass, setButtonClass] = useState(\"disabled\");\r\n\r\n  const handleSignup = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const usernameExists = await doesUsernameExist(username);\r\n    if (!usernameExists) {\r\n      try {\r\n        const createdUserResult = await firebase\r\n          .auth()\r\n          .createUserWithEmailAndPassword(emailAddress, password);\r\n\r\n        await createdUserResult.user.updateProfile({\r\n          displayName: username,\r\n        });\r\n        var userDocRef = await firebase.firestore().collection(\"users\").doc();\r\n        userDocRef.set({\r\n          userId: createdUserResult.user.uid,\r\n          username: username,\r\n          fullName,\r\n          emailAddress: emailAddress.toLowerCase(),\r\n          dateCreated: Date.now(),\r\n          docId: userDocRef.id,\r\n        });\r\n\r\n        var listsDocRef = userDocRef.collection(\"lists\").doc();\r\n        var tasksInListDocRef = listsDocRef.collection(\"tasks\").doc();\r\n        var tasksMainDocRef = userDocRef.collection(\"tasks\").doc();\r\n        var listName = \"New\";\r\n        var taskName = \"Create a list or a task!\";\r\n        var dateCreated = Date.now();\r\n\r\n        listsDocRef.set({\r\n          listId: listsDocRef.id,\r\n          listName: listName,\r\n          dateCreated: dateCreated,\r\n        });\r\n\r\n        tasksInListDocRef.set({\r\n          taskName: taskName,\r\n          taskIdList: tasksInListDocRef.id,\r\n          taskIdMain: tasksMainDocRef.id,\r\n          dateCreated: dateCreated,\r\n          urgent: false,\r\n          completed: false,\r\n          due: dateCreated,\r\n        });\r\n\r\n        tasksMainDocRef.set({\r\n          taskName: taskName,\r\n          taskIdList: tasksInListDocRef.id,\r\n          taskIdMain: tasksMainDocRef.id,\r\n          dateCreated: dateCreated,\r\n          urgent: false,\r\n          completed: false,\r\n          due: dateCreated,\r\n        });\r\n\r\n        history.push(ROUTES.DASHBOARD);\r\n      } catch (error) {\r\n        setFullName(\"\");\r\n        setEmailAddress(\"\");\r\n        setPassword(\"\");\r\n        setError(error.message);\r\n      }\r\n    } else {\r\n      setError(\"That username is already taken\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    isInvalid ? setButtonClass(\"disabled\") : setButtonClass(\"able\");\r\n  }, [isInvalid]);\r\n\r\n  useEffect(() => {\r\n    document.title = \"Sign-up - To Do\";\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {/* <Navbar /> */}\r\n      <div className=\"signup\">\r\n        <div className=\"container\">\r\n          <div className=\"modal\">\r\n            <h2>Signup</h2>\r\n            {error && <p className=\"error\">{error}</p>}\r\n            <form onSubmit={handleSignup}>\r\n              {/* username */}\r\n              <input\r\n                aria-label=\"Enter your username\"\r\n                type=\"test\"\r\n                placeholder=\"Username\"\r\n                onChange={({ target }) => setUsername(target.value)}\r\n                value={username}\r\n              />\r\n              {/* full name */}\r\n              <input\r\n                aria-label=\"Enter your full name\"\r\n                type=\"test\"\r\n                placeholder=\"Full name\"\r\n                onChange={({ target }) => setFullName(target.value)}\r\n                value={fullName}\r\n              />\r\n              {/* email */}\r\n              <input\r\n                aria-label=\"Enter your email address\"\r\n                type=\"test\"\r\n                placeholder=\"Email address\"\r\n                onChange={({ target }) => setEmailAddress(target.value)}\r\n                value={emailAddress}\r\n              />\r\n              {/* password */}\r\n              <input\r\n                aria-label=\"Enter your password\"\r\n                type=\"password\"\r\n                placeholder=\"Password\"\r\n                onChange={({ target }) => setPassword(target.value)}\r\n                value={password}\r\n              />\r\n              {/* login button */}\r\n              <button\r\n                className={buttonClass}\r\n                disabled={isInvalid}\r\n                type=\"submit\"\r\n              >\r\n                Sign-up\r\n              </button>\r\n            </form>\r\n          </div>\r\n          <div className=\"already\">\r\n            Already have an account?{\" \"}\r\n            <Link to={ROUTES.LOGIN} className=\"link\">\r\n              Log In\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"sourceRoot":""}